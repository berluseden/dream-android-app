# üìã Levantamiento Funcional Completo
## App Hipertrofia - Sistema de Planificaci√≥n de Entrenamientos

**Fecha:** 17 de Octubre, 2025  
**Estado:** Producci√≥n (MVP)  
**Repositorio:** berluseden/dream-android-app  
**Branch:** main

---

## üìä Resumen Ejecutivo

### Stack Tecnol√≥gico
- **Frontend:** React 18 + Vite + TypeScript
- **UI:** TailwindCSS + Radix UI (shadcn/ui)
- **Backend:** Firebase (Auth, Firestore, Cloud Functions, Storage)
- **Estado Global:** TanStack Query (React Query) v5
- **Routing:** React Router v6
- **PWA:** vite-plugin-pwa con Service Worker
- **Runtime:** Node 18 (Cloud Functions)

### Dependencias Principales
```json
{
  "firebase": "^12.4.0",
  "@tanstack/react-query": "^5.83.0",
  "react": "^18.3.1",
  "react-router-dom": "^6.30.1",
  "framer-motion": "^11.18.2",
  "recharts": "^2.15.4",
  "date-fns": "^3.6.0",
  "zod": "^3.25.76",
  "react-hook-form": "^7.61.1"
}
```

---

## üèóÔ∏è Arquitectura del Sistema

### Modelo de Datos (Firestore)

#### Colecciones Principales

**1. `users/` - Perfiles de Usuario**
```typescript
{
  email: string;
  name: string;
  equipment: string[];            // Equipamiento disponible
  level: 'novato' | 'intermedio' | 'avanzado';
  experience_years: number;
  goals: string;
  units: 'kg' | 'lbs';
  coach_id: string | null;        // Coach asignado
  created_at: Timestamp;
  updated_at: Timestamp;
}
```

**2. `user_roles/` - Sistema de Roles (Separado por Seguridad)**
```typescript
{
  // Document ID = user_id
  role: 'admin' | 'coach' | 'user';
}
```

**3. `muscles/` - Cat√°logo de M√∫sculos**
```typescript
{
  name: string;                   // ej: "Pectorales"
  category: string;               // ej: "upper_body"
  recovery_days: number;          // D√≠as de recuperaci√≥n t√≠picos
}
```

**4. `exercises/` - Biblioteca de Ejercicios**
```typescript
{
  name: string;
  prime_muscle: string;           // M√∫sculo principal
  secondary_muscles: string[];    // M√∫sculos secundarios
  equipment: string[];            // Equipamiento requerido
  difficulty: 'novato' | 'intermedio' | 'avanzado';
  instructions: string;
  video_url: string | null;
  created_by: string;
  created_at: Timestamp;
}
```

**5. `mesocycles/` - Ciclos de Entrenamiento**
```typescript
{
  user_id: string;
  coach_id: string | null;
  name: string;
  start_date: Timestamp;
  length_weeks: number;           // Duraci√≥n total (ej: 6 semanas)
  specialization: string[];       // M√∫sculos a especializar
  effort_scale: 'RIR' | 'RPE';    // Sistema de esfuerzo
  status: 'planned' | 'active' | 'completed' | 'paused';
  created_at: Timestamp;
  updated_at: Timestamp;
  created_by: string;
  last_modified_by: string;
}
```

**6. `weekly_targets/` - Objetivos Semanales de Volumen**
```typescript
{
  mesocycle_id: string;
  muscle_id: string;
  week_number: number;            // 1 a length_weeks
  sets_min: number;               // Rango m√≠nimo de sets
  sets_max: number;               // Rango m√°ximo de sets
  sets_target: number;            // Sets objetivo
  actual_sets: number;            // Sets completados (auto-actualizado)
}
```
**Progresi√≥n:** 60% ‚Üí 70% ‚Üí 80% ‚Üí 90% ‚Üí 100% ‚Üí 50% (deload)

**7. `workouts/` - Sesiones de Entrenamiento**
```typescript
{
  mesocycle_id: string;
  user_id: string;
  day_index: number;              // D√≠a del mesociclo (0-indexed)
  planned_date: Timestamp;
  completed_at: Timestamp | null;
  status: 'pending' | 'in_progress' | 'completed' | 'skipped';
  duration_minutes: number | null;
  notes: string;
  coach_notes: string | null;
}
```

**8. `sets/` - Registro de Series**
```typescript
{
  workout_id: string;
  exercise_id: string;
  set_number: number;             // N√∫mero de serie (1, 2, 3...)
  set_type: 'warmup' | 'working' | 'dropset' | 'backoff';
  target_reps: number;
  rir_target: number;             // RIR objetivo
  load: number;                   // Carga en kg/lbs
  completed_reps: number;
  rir_actual: number;             // RIR real
  rpe: number;                    // RPE (1-10)
  perceived_pump: number;         // Pump 1-10
  perceived_soreness: number;     // Soreness 1-10
  notes: string;
  rest_seconds?: number;
  tempo?: string;
  technique?: string;
  superset_group_id?: string;     // UUID para agrupar superseries
  created_at: Timestamp;
  modified_by: string;
}
```

**9. `exercise_feedback/` - Feedback Post-Ejercicio**
```typescript
{
  workout_id: string;
  exercise_id: string;
  user_id: string;
  muscle_soreness: 'never_sore' | 'healed_while_ago' | 'just_on_time' | 'still_sore';
  pump_quality: 'low' | 'moderate' | 'amazing';
  workload_feeling: 'easy' | 'pretty_good' | 'pushed_limits' | 'too_much';
  notes?: string;
  created_at: Timestamp;
}
```

**10. `user_strength_profile/` - Perfiles de Fuerza (Calibraci√≥n)**
```typescript
{
  // Document ID = {user_id}_{pattern}
  user_id: string;
  pattern: 'squat' | 'bench' | 'row' | 'overhead_press' | 'deadlift';
  e1rm: number;                   // 1RM estimado
  last_calibration_date: Timestamp;
  calibration_data: {
    load: number;
    reps: number;
    rir: number;
  };
}
```

**11. `messages/` - Mensajer√≠a Coach-Cliente**
```typescript
{
  from_id: string;
  to_id: string;
  content: string;
  read: boolean;
  created_at: Timestamp;
}
```

**12. `coach_assignments/` - Asignaciones Coach-Cliente**
```typescript
{
  coach_id: string;
  client_id: string;
  assigned_at: Timestamp;
  status: 'active' | 'inactive';
}
```

**13. `templates/` - Plantillas de Programas**
```typescript
{
  name: string;
  description: string;
  level: 'novato' | 'intermedio' | 'avanzado';
  focus: 'strength' | 'hypertrophy' | 'powerbuilding';
  muscle_focus: string[];         // ['chest', 'back', 'quads']
  required_equipment: string[];   // ['barbell', 'dumbbells', 'machines']
  days_per_week: number;
  length_weeks: number;
  rating: number;                 // 1-5 estrellas
  popularity: number;             // Veces usado
  structure: {
    day: number;
    name: string;
    muscle_groups: string[];
    exercises: Array<{
      exercise_id: string;
      sets: number;
      reps_min: number;
      reps_max: number;
      rir: number;
    }>;
  }[];
}
```

**14. `mesocycle_versions/` - Historial de Cambios**
```typescript
{
  mesocycle_id: string;
  version: number;
  created_by: string;
  created_at: Timestamp;
  changelog: string;
  changes: Array<{
    type: 'volume_increase' | 'volume_decrease' | 'exercise_swap' | 'rest_day_added';
    affected_weeks: number[];
    details: string;
  }>;
}
```

**15. `invitations/` - Sistema de Invitaciones**
```typescript
{
  email: string;
  role: 'coach' | 'user';
  sent_by: string;
  status: 'pending' | 'accepted' | 'expired' | 'revoked';
  token: string;
  expires_at: Timestamp;
  created_at: Timestamp;
}
```

**16. `audit_logs/` - Logs de Auditor√≠a (Admin)**
```typescript
{
  user_id: string;
  action: string;
  resource: string;
  resource_id: string;
  metadata: any;
  timestamp: Timestamp;
}
```

**17. `backups/` - Trabajos de Backup**
```typescript
{
  created_by: string;
  status: 'pending' | 'running' | 'completed' | 'failed';
  collections: string[];
  file_path: string | null;
  created_at: Timestamp;
  completed_at: Timestamp | null;
}
```

**18. `admin_settings/` - Configuraci√≥n Global**
```typescript
{
  // Document ID = 'system'
  maintenance_mode: boolean;
  allowed_domains: string[];
  max_clients_per_coach: number;
}
```

---

## üîê Sistema de Autenticaci√≥n y Autorizaci√≥n

### Roles y Permisos

#### 1. **Admin**
- Acceso completo a todos los recursos
- Gesti√≥n de usuarios, roles y coaches
- CRUD de cat√°logos (m√∫sculos, ejercicios)
- Seed de datos iniciales
- Auditor√≠a y backups
- Configuraci√≥n del sistema

#### 2. **Coach**
- Ver/editar clientes asignados
- Crear y modificar mesociclos de sus clientes
- Ver progreso y estad√≠sticas de clientes
- Enviar mensajes a clientes
- Crear ejercicios personalizados (solo visibles para sus clientes)

#### 3. **User** (Cliente)
- Ver su propio perfil y plan
- Registrar entrenamientos
- Ver progreso y estad√≠sticas personales
- Recibir mensajes de su coach
- Feedback post-ejercicio

### Firestore Security Rules

**Funciones de Utilidad:**
```javascript
function isAuthenticated() {
  return request.auth != null;
}

function getUserRole() {
  let roleDoc = get(/databases/$(database)/documents/user_roles/$(request.auth.uid));
  return roleDoc.data.role;
}

function isAdmin() {
  return isAuthenticated() && getUserRole() == 'admin';
}

function isCoach() {
  return isAuthenticated() && getUserRole() == 'coach';
}

function isOwner(userId) {
  return isAuthenticated() && request.auth.uid == userId;
}

function isAssignedCoach(clientId) {
  return isCoach() && 
         get(/databases/$(database)/documents/users/$(clientId)).data.coach_id == request.auth.uid;
}
```

**Reglas Clave:**
- `users/`: Solo owner, coach asignado o admin
- `user_roles/`: Solo admin (cr√≠tico para seguridad)
- `exercises/`: Lectura p√∫blica, escritura admin/coach
- `mesocycles/`, `workouts/`, `sets/`: Solo owner o coach asignado
- `messages/`: Solo participantes de la conversaci√≥n

---

## üéØ Funcionalidades Implementadas

### Sprint 1: Velocity & Onboarding ‚úÖ

#### 1. **Calculadora de Placas Inline**
- **Hook:** `usePlateCalculator()`
- **Componente:** `PlateCalculator.tsx`
- **Funcionalidad:**
  - Modal r√°pido con c√°lculo de combinaci√≥n √≥ptima
  - Soporte para barras: Ol√≠mpica (20kg), Est√°ndar (15kg), EZ (10kg)
  - Ajuste r√°pido: +/-10kg, +/-5kg, +/-2.5kg
  - C√≥digo de colores por peso
  - Preferencias personalizables (`PlatePreferences.tsx`)

#### 2. **Warmups Autom√°ticos**
- **Librer√≠a:** `lib/warmupGenerator.ts`
- **Funci√≥n:** `generateWarmups(workingLoad, isCompound)`
- **L√≥gica:**
  - Detecta ejercicios compound (squat, bench, deadlift, etc.)
  - Genera 2-3 sets: 50% √ó 8, 65% √ó 6, 80% √ó 3
  - Integrado en `ExerciseCard` como collapsible
  - Opci√≥n "Saltar Calentamiento"

#### 3. **Onboarding de Calibraci√≥n**
- **P√°gina:** `pages/onboarding/Calibration.tsx`
- **Hook:** `useStrengthProfile()`
- **Flujo:**
  - Wizard de 4 patrones: Squat, Bench, Row, Overhead Press
  - Registro de carga, reps, RIR por patr√≥n
  - C√°lculo autom√°tico de e1RM con `calculateE1RMWithRIR()`
  - Banner en dashboard si calibraci√≥n incompleta
  - Soporte para m√∫ltiples sets (1-3 sets por patr√≥n)
  - Bot√≥n "Importar pesos previos" (placeholder)

### Sprint 2: Expansi√≥n ‚úÖ (60% completado)

#### 4. **Biblioteca de Programas Extendida**
- **Hook:** `usePrograms()`
- **Componentes:** 
  - `ProgramFilters.tsx` - Filtros avanzados
  - `ProgramCard.tsx` - Visualizaci√≥n de programas
  - `ProgramPreviewModal.tsx` - Preview detallado
- **Plantillas Agregadas:**
  1. GBR 4D (Generic Bulking Routine)
  2. PHUL 4D (Power Hypertrophy Upper Lower)
  3. PHAT 5D (Layne Norton)
  4. Bro Split 5D (Intermedio - Hipertrofia)
  5. Full Body 3D (Novato - Hipertrofia)
- **Filtros:**
  - Nivel: Novato, Intermedio, Avanzado
  - Equipamiento: Barra, Mancuernas, M√°quinas, Peso corporal, Poleas
  - Enfoque: Fuerza, Hipertrofia, Powerbuilding
  - D√≠as/semana: 3, 4, 5, 6 d√≠as

#### 5. **Supersets (Visual Base)**
- **Campo:** `set.superset_group_id` (UUID)
- **UI:** Border lateral + Badge "SS" en `ExerciseCard`
- **Pendiente:** Bot√≥n para crear superseries (dialog de selecci√≥n)

### Sprint 3 & 4: Nice-to-Have + Gamificaci√≥n ‚úÖ (85% completado)

#### 6. **Versionado de Mesociclos**
- **Componente:** `MesocycleVersionHistory.tsx`
- **Hook:** `useMesocycleVersions()`
- **Funcionalidad:**
  - Historial completo de versiones (v1, v2, v3...)
  - Changelog descriptivo con iconos
  - Tipos de cambios: volume_increase, volume_decrease, exercise_swap
  - Bot√≥n "Clonar" versi√≥n anterior

#### 7. **Resumen Anual (Yearly Stats)**
- **P√°gina:** `pages/stats/Yearly.tsx`
- **Funcionalidad:**
  - **Hero Cards:**
    - Volumen Total (kg levantados)
    - Sets Totales
    - Adherencia (%)
  - **Top 3 Ejercicios:** Ranking con medallas ü•áü•àü•â
  - **Trofeos Desbloqueables:**
    - Consistente (‚â•90% adherencia)
    - Beast Mode (1000+ sets)
    - Streak Master (‚â•95% adherencia)
  - Gradientes tem√°ticos, cards con border, responsive

#### 8. **Auditor√≠a de Accesibilidad**
- ‚úÖ Contraste WCAG AA (m√≠nimo 4.5:1)
- ‚úÖ Aria-labels en botones sin texto
- ‚úÖ Navegaci√≥n por teclado (Tab, Enter, Escape)
- ‚úÖ Sem√°ntica HTML correcta
- ‚úÖ Alt en SVGs (role="img")
- ‚úÖ Lighthouse Score: Performance ‚â•90, Accessibility ‚â•95

#### 9. **Hooks de Wearables (Placeholder)**
- **Hook:** `useWearableIntegration()`
- Preparado para: Apple HealthKit, Google Fit, Fitbit
- `isAvailable: false` (no implementado)

### Funcionalidades Core (Fase Base)

#### 10. **Dashboard Principal**
- **P√°gina:** `pages/Index.tsx`
- **Componentes:**
  - Hero header con resumen de mesociclo activo
  - Cards de stats r√°pidos (volumen semanal, adherencia, workout hoy)
  - Gr√°fico de volumen por m√∫sculo (planificado vs realizado)
  - Gr√°fico de progresi√≥n de fatiga (RIR simulado)
  - Banner de calibraci√≥n incompleta
  - Resumen semanal con ajustes recientes
  - Bot√≥n seed para admins (desarrollo)

#### 11. **Biblioteca de Ejercicios**
- **P√°gina:** `pages/Exercises.tsx`
- **Hook:** `useExercises()`
- **Funcionalidad:**
  - Cat√°logo completo con filtros
  - B√∫squeda por nombre, m√∫sculo, equipamiento
  - Vista detallada (instrucciones, video_url)
  - CRUD para admin/coach

#### 12. **Entrenamiento del D√≠a**
- **P√°gina:** `pages/TodayWorkout.tsx`
- **Hooks:** `useTodayWorkout()`, `useWorkoutSets()`
- **Componentes:**
  - `WorkoutHeader` - Timer, estado, botones
  - `ExerciseThumbnailCarousel` - Vista general de ejercicios
  - `ExerciseCard` - Sets, warmups, sugerencias de carga
  - `SetRowInline` - Registro r√°pido de series
  - `FeedbackDialog` - Feedback post-ejercicio
  - `RestTimer` - Temporizador de descanso
- **Flujo:**
  1. Usuario hace clic en "Comenzar"
  2. Timer inicia
  3. Registra sets con load, reps, RIR, RPE
  4. Sugerencias autom√°ticas de carga (algoritmo)
  5. Warmups generados autom√°ticamente
  6. Feedback post-ejercicio (pump, soreness, workload)
  7. "Completar Workout" ‚Üí guarda duraci√≥n

#### 13. **Panel de Coach**
- **P√°gina:** `pages/coach/Clients.tsx`
- **Hook:** `useCoachClients()`
- **Componentes:**
  - `ClientAdherenceChart` - Adherencia por semana
  - `ClientPRsList` - PRs recientes del cliente
  - `FatigueAlerts` - Alertas de fatiga excesiva
  - `VolumeHeatmap` - Heatmap de volumen por m√∫sculo
  - `PublishChangesDialog` - Publicar cambios a cliente
- **Stats por Cliente:**
  - Volumen semanal
  - Adherencia
  - Estado del mesociclo
  - Alertas de fatiga

#### 14. **Creaci√≥n de Mesociclos**
- **P√°gina:** `pages/mesocycles/CreateMesocycle.tsx`
- **Hook:** `useCreateMesocycle()`
- **Funcionalidad:**
  - Wizard de creaci√≥n paso a paso
  - Selecci√≥n de m√∫sculos a especializar
  - Definici√≥n de rangos de volumen por m√∫sculo
  - Duraci√≥n (4-12 semanas)
  - Sistema de esfuerzo (RIR o RPE)
  - Generaci√≥n autom√°tica de weekly_targets con progresi√≥n

#### 15. **Progreso y Estad√≠sticas**
- **P√°gina:** `pages/Progress.tsx`
- **Hooks:**
  - `useWeeklyVolume()` - Volumen semanal
  - `useAdherence()` - % de adherencia
  - `useVolumeByMuscle()` - Volumen por m√∫sculo
  - `useClientKPIs()` - KPIs del cliente (coach view)
  - `useVolumeComparison()` - Comparativa de volumen
  - `useRIRDistribution()` - Distribuci√≥n de RIR
- **Componentes:**
  - `MuscleVolumeTracker` - Tracker de volumen por m√∫sculo
  - Gr√°ficos de progresi√≥n (Recharts)
  - Cards de stats clave

#### 16. **Mensajer√≠a**
- **P√°gina:** `pages/Messages.tsx`
- **Hook:** `useMessages()`
- **Funcionalidad:**
  - Chat en tiempo real coach-cliente
  - Notificaciones de mensajes no le√≠dos
  - Marca como le√≠do autom√°ticamente

#### 17. **Configuraci√≥n**
- **P√°gina:** `pages/Settings.tsx`
- **Hook:** `useSettings()`
- **Secciones:**
  - Perfil (nombre, email)
  - Equipamiento disponible
  - Nivel y experiencia
  - Unidades (kg/lbs)
  - Preferencias de placas

---

## üß† Algoritmos de Autorregulaci√≥n

### Archivo: `lib/algorithms.ts`

#### 1. **calculateNextLoad()**
**Entrada:** Historial de sets (load, reps, RIR)  
**Salida:** Sugerencia de carga y reps con explicaci√≥n

**L√≥gica:**
```typescript
Si RIR promedio ‚â§ 0.5 y complet√≥ reps:
  ‚Üí +5% carga, mantener reps
  
Si RIR promedio ‚â§ 1.5:
  ‚Üí Mantener carga, +1 rep
  
Si RIR promedio ‚â• 3:
  ‚Üí -10% carga (demasiado lejos del fallo)
  
Caso contrario:
  ‚Üí Mantener
```

**Ejemplo:**
- Historial: [100kg √ó 10 @RIR 1, 100kg √ó 9 @RIR 1, 100kg √ó 8 @RIR 2]
- RIR promedio: 1.33
- Sugerencia: **100kg √ó 11 reps** ("Aumentar repeticiones")
- Alternativa: **102.5kg √ó 10 reps** ("Aumentar carga +2.5%")

#### 2. **calculateE1RMWithRIR()**
**Entrada:** load, reps, rir  
**Salida:** e1RM estimado

**F√≥rmula de Epley ajustada por RIR:**
```typescript
totalReps = reps + rir
e1RM = load √ó (1 + totalReps / 30)
```

**Ejemplo:**
- 100kg √ó 8 reps @RIR 2
- totalReps = 8 + 2 = 10
- e1RM = 100 √ó (1 + 10/30) = 100 √ó 1.33 = **133kg**

#### 3. **detectPlateau()**
**Entrada:** Historial de sets  
**Salida:** `{ isPlateaued: boolean, sessionsWithoutImprovement: number }`

**L√≥gica:**
- Calcula e1RM de cada sesi√≥n
- Si 3+ sesiones consecutivas sin mejora ‚Üí Estancamiento
- Sugerencia: Cambiar ejercicio, aumentar volumen o tomar deload

#### 4. **calculateVolumeAdjustment()**
**Entrada:** Scores de pump y soreness  
**Salida:** Ajuste de volumen (%, sets)

**L√≥gica:**
```typescript
Si soreness promedio ‚â• 6:
  ‚Üí Reducir 20% volumen (fatiga excesiva)
  
Si pump promedio ‚â§ 3 Y soreness promedio ‚â§ 3:
  ‚Üí A√±adir 1 set (respuesta baja)
  
Caso contrario:
  ‚Üí Mantener volumen
```

#### 5. **calculateOptimalRIR()**
**Entrada:** Tipo de ejercicio, semana del mesociclo  
**Salida:** RIR √≥ptimo

**L√≥gica:**
```typescript
Exercises compound: RIR = 2-3 (evitar fallo t√©cnico)
Exercises isolation: RIR = 0-2 (seguro ir al fallo)

Si semana ‚â• 5 (deload):
  RIR = 4-5
```

---

## üîÑ Cloud Functions (Backend)

### Archivo: `functions/src/index.ts`

#### 1. **adjustWeeklyVolume** (Cron: Domingos 23:00)
**Trigger:** `pubsub.schedule('0 23 * * 0')`  
**Funcionalidad:**
- Analiza la semana completada de cada mesociclo activo
- Calcula fatiga por m√∫sculo (pump + soreness)
- Ajusta weekly_targets de la siguiente semana
- L√≥gica: `calculateVolumeAdjustment()`

#### 2. **notifyPendingWorkouts** (Cron: Diario 08:00)
**Trigger:** `pubsub.schedule('0 8 * * *')`  
**Funcionalidad:**
- Busca workouts con `status: 'pending'` y `planned_date: today`
- Env√≠a notificaci√≥n push (FCM) o email
- Marca notificaci√≥n enviada

#### 3. **Admin Functions** (HTTP Callable)
- `createUserWithRole` - Crear usuario con rol espec√≠fico
- `sendInvitation` - Enviar invitaci√≥n por email con token
- `setUserRole` - Cambiar rol de usuario
- `disableUser` - Deshabilitar cuenta
- `deleteUser` - Eliminar usuario (+ cleanup de datos)
- `resetUserPassword` - Reset de contrase√±a por admin
- `revokeInvitation` - Revocar invitaci√≥n
- `assignCoach` - Asignar coach a cliente

#### 4. **Seed & Backup Functions**
- `seedCatalogs` - Seed de m√∫sculos, ejercicios y templates
- `backupCollections` - Exportar colecciones a JSON (Storage)
- `reindexComputedFields` - Recalcular campos computed (ej: actual_sets)

**Nota:** `generateYearSummary` (PDF) y `syncWearableData` est√°n documentados pero no implementados (backlog).

---

## üì± PWA (Progressive Web App)

### Configuraci√≥n: `vite-plugin-pwa`

**Service Worker:**
- Estrategia: NetworkFirst para APIs, CacheFirst para assets
- Precach√©: index.html, main.js, estilos
- Runtime cach√©: Firebase API calls

**Manifest (`public/manifest.webmanifest`):**
```json
{
  "name": "App Hipertrofia",
  "short_name": "Hipertrofia",
  "start_url": "/",
  "display": "standalone",
  "theme_color": "#000000",
  "background_color": "#ffffff",
  "icons": [
    { "src": "/icons/icon-192.png", "sizes": "192x192", "type": "image/png" },
    { "src": "/icons/icon-512.png", "sizes": "512x512", "type": "image/png" }
  ]
}
```

**Funcionalidad:**
- Instalable en Android/iOS
- Funciona offline (cach√© local)
- Splash screens personalizadas
- Banner de actualizaci√≥n (`UpdateBanner.tsx`)

---

## üé® Sistema de Dise√±o

### Tokens Sem√°nticos (TailwindCSS)

**Colores:**
```css
/* index.css */
--primary: 220 100% 60%;       /* Azul principal */
--secondary: 270 60% 70%;      /* P√∫rpura */
--accent: 40 100% 60%;         /* Amarillo/Naranja */
--background: 0 0% 100%;       /* Blanco */
--foreground: 222 47% 11%;     /* Texto oscuro */
--muted: 210 40% 96%;          /* Gris claro */
--destructive: 0 84% 60%;      /* Rojo */
--success: 142 76% 36%;        /* Verde */
```

**Gradientes:**
```css
.bg-gradient-primary {
  background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--accent)));
}

.bg-gradient-success {
  background: linear-gradient(135deg, #10b981, #34d399);
}
```

**Componentes (shadcn/ui):**
- Button, Card, Dialog, Dropdown, Tabs, Accordion, Toast
- Todos responsive, accesibles, customizables
- Variantes: default, destructive, outline, ghost, link

---

## üìÇ Estructura de Directorios

```
/workspaces/dream-android-app/
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ manifest.webmanifest
‚îÇ   ‚îú‚îÄ‚îÄ robots.txt
‚îÇ   ‚îú‚îÄ‚îÄ icons/                  # Iconos PWA (192, 512)
‚îÇ   ‚îî‚îÄ‚îÄ splash/                 # Splash screens iOS/Android
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/              # Componentes admin (guards, layouts, dialogs)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/               # ProtectedRoute, RoleGuard
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ coach/              # ClientAdherenceChart, FatigueAlerts, etc.
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/             # AppLayout, AppSidebar
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ notifications/      # MesocycleUpdateNotification
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ programs/           # ProgramFilters, ProgramCard, ProgramPreviewModal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ progress/           # MuscleVolumeTracker
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pwa/                # UpdateBanner
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings/           # PlatePreferences
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                 # Componentes shadcn (button, card, dialog, etc.)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ workout/            # ExerciseCard, SetRowInline, FeedbackDialog, etc.
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.tsx         # Autenticaci√≥n y roles
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useWorkouts.tsx     # CRUD de workouts y sets
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useMesocycles.tsx   # CRUD de mesociclos y weekly_targets
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useExercises.tsx    # Biblioteca de ejercicios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useStats.tsx        # Estad√≠sticas (volumen, adherencia, etc.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useStrengthProfile.tsx  # Calibraci√≥n de e1RM
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usePrograms.tsx     # Templates de programas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAdmin.tsx        # Funciones admin (CRUD usuarios, roles)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useCoaches.tsx      # Coaches y clientes asignados
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useMessages.tsx     # Mensajer√≠a
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useInvitations.tsx  # Sistema de invitaciones
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuditLogs.tsx    # Logs de auditor√≠a
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useBackups.tsx      # Trabajos de backup
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAdminSettings.tsx # Configuraci√≥n global
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usePlateCalculator.tsx # Calculadora de placas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useWearableIntegration.tsx # Placeholder wearables
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useRecentAdjustments.tsx # Ajustes recientes de algoritmo
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useWeeklySummary.tsx # Resumen semanal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useClientKPIs.tsx   # KPIs de cliente (coach view)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useVolumeComparison.tsx # Comparativa de volumen
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useRIRDistribution.tsx # Distribuci√≥n de RIR
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useExerciseFeedback.tsx # Feedback post-ejercicio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useExerciseSubstitution.tsx # Sustituci√≥n de ejercicios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useMesocycleVersions.tsx # Versionado de mesociclos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ use-toast.ts        # Toast notifications
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ firebase.ts         # Inicializaci√≥n de Firebase
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ algorithms.ts       # Algoritmos de autorregulaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ warmupGenerator.ts  # Generaci√≥n de warmups
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exerciseMatching.ts # Matching de ejercicios para sustituci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ offlineQueue.ts     # Cola de acciones offline
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gestures.ts         # Gestos m√≥viles (swipe, long-press)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts            # Utilidades generales (cn, formatters)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/              # P√°ginas admin (Dashboard, Users, Roles, etc.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ coach/              # Clients.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mesocycles/         # CreateMesocycle.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ onboarding/         # Calibration.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ programs/           # (futuro: browse, create)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stats/              # Yearly.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Auth.tsx            # Login/Register
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Index.tsx           # Dashboard principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Exercises.tsx       # Biblioteca de ejercicios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Workouts.tsx        # Lista de workouts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TodayWorkout.tsx    # Entrenamiento del d√≠a
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Progress.tsx        # Progreso y stats
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Messages.tsx        # Mensajer√≠a
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Settings.tsx        # Configuraci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NotFound.tsx        # 404
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Unauthorized.tsx    # 403
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ seedFirestore.ts    # Script de seed (client-side)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.types.ts      # Tipos admin (Template, Invitation, etc.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ strength.types.ts   # Tipos de fuerza (StrengthProfile, PlatePreferences)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.types.ts       # Tipos de usuario (UserProfile, UserRole)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx                 # Router principal
‚îÇ   ‚îú‚îÄ‚îÄ main.tsx                # Entry point
‚îÇ   ‚îú‚îÄ‚îÄ index.css               # Estilos globales + tokens
‚îÇ   ‚îî‚îÄ‚îÄ vite-env.d.ts           # Types de Vite
‚îÇ
‚îú‚îÄ‚îÄ functions/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts            # Exportaci√≥n de funciones
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.ts            # Funciones admin (createUser, setRole, etc.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ seed.ts             # Seed de cat√°logos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ backup.ts           # Funciones de backup
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ audit.ts            # Auditor√≠a
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types.ts            # Tipos compartidos
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ tsconfig.json
‚îÇ
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ gbr-4d.json             # Generic Bulking Routine
‚îÇ   ‚îú‚îÄ‚îÄ phul-4d.json            # Power Hypertrophy Upper Lower
‚îÇ   ‚îî‚îÄ‚îÄ phat-5d.json            # Layne Norton PHAT
‚îÇ
‚îú‚îÄ‚îÄ firestore.rules             # Reglas de seguridad
‚îú‚îÄ‚îÄ firestore.indexes.json      # √çndices compuestos
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ vite.config.ts
‚îú‚îÄ‚îÄ tailwind.config.ts
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ MOBILE_PWA.md               # Gu√≠a de PWA
‚îú‚îÄ‚îÄ SPRINT1_FEATURES.md         # Sprint 1 (completado)
‚îú‚îÄ‚îÄ SPRINT2_FEATURES.md         # Sprint 2 (60% completado)
‚îú‚îÄ‚îÄ SPRINT3-4_FEATURES.md       # Sprint 3-4 (85% completado)
‚îî‚îÄ‚îÄ LEVANTAMIENTO_FUNCIONAL.md  # Este documento
```

---

## üöÄ Flujos de Usuario Principales

### 1. **Nuevo Usuario ‚Üí Primera Calibraci√≥n**
```
1. Registro (email/password o Google)
2. Crear perfil (equipamiento, nivel, experiencia)
3. Dashboard ‚Üí Banner "Completa tu calibraci√≥n"
4. Clic en "Comenzar Calibraci√≥n"
5. Navega a /onboarding/calibration
6. Completa 4 patrones: Squat, Bench, Row, Overhead Press
   - Por cada patr√≥n: registra load, reps, RIR
   - Opci√≥n: agregar 1-3 sets para mayor precisi√≥n
7. Sistema calcula e1RM promedio
8. Guarda en user_strength_profile
9. Dashboard deja de mostrar banner
10. Usuario listo para crear primer mesociclo
```

### 2. **Crear Mesociclo**
```
1. Dashboard ‚Üí "Crear Mesociclo"
2. Wizard paso 1: Nombre, fecha inicio, duraci√≥n (4-12 semanas)
3. Wizard paso 2: M√∫sculos a especializar (pecho, espalda, etc.)
4. Wizard paso 3: Definir rangos de volumen por m√∫sculo
   - ej: Pecho: 10-20 sets, target 15 sets
5. Wizard paso 4: Sistema de esfuerzo (RIR o RPE)
6. Sistema genera:
   - Mesociclo con status 'planned'
   - weekly_targets con progresi√≥n (60% ‚Üí 100% ‚Üí deload)
   - Workouts vac√≠os (se llenan con ejercicios despu√©s)
7. Mesociclo aparece en dashboard como "Activo"
```

### 3. **Registrar Entrenamiento**
```
1. Dashboard ‚Üí "Workout de Hoy" o navegar a /workout/today
2. Vista de workout con ejercicios programados
3. Clic en "Comenzar" ‚Üí Timer inicia
4. Por cada ejercicio:
   a. Ver warmups generados autom√°ticamente (si es compound)
   b. Completar warmups (50%, 65%, 80% de carga de trabajo)
   c. Registrar working sets:
      - Load (kg/lbs) - con calculadora de placas inline
      - Reps completadas
      - RIR actual (0-4)
      - RPE (1-10)
   d. Sistema sugiere carga para pr√≥ximo set (algoritmo)
   e. Timer de descanso autom√°tico (ej: 180s)
5. Al terminar ejercicio ‚Üí Feedback Dialog:
   - Muscle soreness (never_sore, healed, just_on_time, still_sore)
   - Pump quality (low, moderate, amazing)
   - Workload feeling (easy, pretty_good, pushed_limits, too_much)
6. Repetir para todos los ejercicios
7. Clic en "Completar Workout" ‚Üí guarda duraci√≥n
8. Workout marcado como 'completed'
9. weekly_targets.actual_sets se actualiza autom√°ticamente
```

### 4. **Coach Revisa Progreso de Cliente**
```
1. Coach navega a /coach/clients
2. Ve lista de clientes asignados
3. Clic en cliente ‚Üí Detalles:
   - Adherencia semanal (gr√°fico)
   - Volumen por m√∫sculo (heatmap)
   - PRs recientes (√∫ltimos 30 d√≠as)
   - Alertas de fatiga (si soreness ‚â• 6)
4. Coach decide hacer ajuste:
   - Clic en "Editar Mesociclo"
   - Reduce volumen de pecho 20% (fatiga alta)
   - Cambia ejercicio (press banca ‚Üí press inclinado)
5. Sistema crea nueva versi√≥n (v2) con changelog
6. Coach publica cambios ‚Üí Cliente recibe notificaci√≥n
7. Cliente ve banner: "Tu coach ha actualizado tu programa"
```

### 5. **Admin Gestiona Sistema**
```
1. Admin navega a /admin
2. Dashboard con m√©tricas:
   - Total usuarios
   - Mesociclos activos
   - Workouts completados hoy
   - Adherencia promedio
3. Admin puede:
   - Crear usuarios con roles espec√≠ficos
   - Enviar invitaciones por email
   - Cambiar roles (user ‚Üí coach, coach ‚Üí admin)
   - Asignar coaches a clientes
   - Editar cat√°logos (m√∫sculos, ejercicios)
   - Ejecutar seed de datos
   - Ver logs de auditor√≠a
   - Crear backups manuales
   - Configurar sistema (modo mantenimiento, max clientes por coach)
```

---

## üîç √çndices Compuestos (Firestore)

### Archivo: `firestore.indexes.json`

```json
{
  "indexes": [
    {
      "collectionGroup": "workouts",
      "queryScope": "COLLECTION",
      "fields": [
        { "fieldPath": "user_id", "order": "ASCENDING" },
        { "fieldPath": "mesocycle_id", "order": "ASCENDING" },
        { "fieldPath": "planned_date", "order": "DESCENDING" }
      ]
    },
    {
      "collectionGroup": "workouts",
      "queryScope": "COLLECTION",
      "fields": [
        { "fieldPath": "user_id", "order": "ASCENDING" },
        { "fieldPath": "status", "order": "ASCENDING" },
        { "fieldPath": "planned_date", "order": "ASCENDING" }
      ]
    },
    {
      "collectionGroup": "sets",
      "queryScope": "COLLECTION",
      "fields": [
        { "fieldPath": "workout_id", "order": "ASCENDING" },
        { "fieldPath": "exercise_id", "order": "ASCENDING" },
        { "fieldPath": "created_at", "order": "DESCENDING" }
      ]
    },
    {
      "collectionGroup": "weekly_targets",
      "queryScope": "COLLECTION",
      "fields": [
        { "fieldPath": "mesocycle_id", "order": "ASCENDING" },
        { "fieldPath": "muscle_id", "order": "ASCENDING" },
        { "fieldPath": "week_number", "order": "ASCENDING" }
      ]
    },
    {
      "collectionGroup": "messages",
      "queryScope": "COLLECTION",
      "fields": [
        { "fieldPath": "to_id", "order": "ASCENDING" },
        { "fieldPath": "read", "order": "ASCENDING" },
        { "fieldPath": "created_at", "order": "DESCENDING" }
      ]
    }
  ],
  "fieldOverrides": []
}
```

---

## üìä M√©tricas de Rendimiento

### Lighthouse Score (Objetivo)
- **Performance:** ‚â•90
- **Accessibility:** ‚â•95
- **Best Practices:** ‚â•90
- **SEO:** ‚â•80

### Bundle Size (Optimizaciones)
- Lazy loading de p√°ginas admin
- Tree-shaking de Radix UI
- Code splitting por ruta
- Optimizaci√≥n de im√°genes (WebP)

### Firebase Quota (Producci√≥n)
- **Firestore Reads:** ~10k/d√≠a (usuario activo)
- **Firestore Writes:** ~500/d√≠a (usuario activo)
- **Cloud Functions Invocations:** ~50/d√≠a
- **Storage:** <100MB (backups JSON)

---

## üêõ Issues Conocidos & Backlog

### Issues T√©cnicos
1. **Hardcoded Admin:** `berluseden@gmail.com` tiene rol admin hardcoded en `useAuth.tsx` (l√≠nea 66) - Remover en producci√≥n
2. **Supersets UI Incompleto:** Falta dialog para crear superseries (solo visual implementado)
3. **Importar Pesos Previos:** Bot√≥n placeholder, falta query de √∫ltimo mesociclo
4. **FCM Push Notifications:** No implementado (requiere config manual en Firebase)
5. **Cloud Function generateYearSummary:** Documentado pero no implementado (generar PDF)

### Funcionalidades Pendientes (Backlog)
- [ ] Pull-to-refresh en m√≥vil
- [ ] Wearables integration (Apple Health, Google Fit)
- [ ] Exportar stats a PDF/CSV
- [ ] Compartir stats en redes sociales
- [ ] Clonar versi√≥n de mesociclo (funcional)
- [ ] Filtro de programas por `muscle_focus`
- [ ] 5 plantillas adicionales (Arnold Split, Stronglifts 5x5, nSuns 531, etc.)
- [ ] Gr√°fico de progresi√≥n anual (line chart)
- [ ] Comparativa a√±o vs a√±o
- [ ] Logros adicionales (ej: "100 d√≠as seguidos")

### Mejoras de UX
- [ ] Dark mode completo (parcialmente implementado)
- [ ] Animaciones de transici√≥n entre p√°ginas
- [ ] Onboarding interactivo con tooltips
- [ ] Tutorial guiado para nuevo usuario
- [ ] Shortcuts de teclado (ej: "n" para nuevo set)

---

## üö¢ Despliegue

### Frontend (Vite + React)
**Opciones:**
1. **Vercel** (Recomendado)
   ```bash
   vercel --prod
   ```
2. **Netlify**
   ```bash
   netlify deploy --prod
   ```
3. **Firebase Hosting**
   ```bash
   npm run build
   firebase deploy --only hosting
   ```

**Build Command:**
```bash
npm run build
# Output: dist/
```

### Backend (Cloud Functions)
**Despliegue:**
```bash
cd functions
npm run build
firebase deploy --only functions
```

**Funciones desplegadas:**
- `adjustWeeklyVolume` (cron: domingos 23:00)
- `notifyPendingWorkouts` (cron: diario 08:00)
- `createUserWithRole` (HTTP callable)
- `sendInvitation` (HTTP callable)
- `setUserRole` (HTTP callable)
- `disableUser` (HTTP callable)
- `deleteUser` (HTTP callable)
- `resetUserPassword` (HTTP callable)
- `revokeInvitation` (HTTP callable)
- `assignCoach` (HTTP callable)
- `seedCatalogs` (HTTP callable)
- `backupCollections` (HTTP callable)
- `reindexComputedFields` (HTTP callable)

### Firestore Rules & Indexes
**Despliegue:**
```bash
firebase deploy --only firestore:rules
firebase deploy --only firestore:indexes
```

### Variables de Entorno (.env)
```env
VITE_FIREBASE_API_KEY=...
VITE_FIREBASE_AUTH_DOMAIN=...
VITE_FIREBASE_PROJECT_ID=...
VITE_FIREBASE_STORAGE_BUCKET=...
VITE_FIREBASE_MESSAGING_SENDER_ID=...
VITE_FIREBASE_APP_ID=...
```

---

## üìö Documentaci√≥n Adicional

### Archivos de Referencia
- `README.md` - Setup inicial y stack tecnol√≥gico
- `MOBILE_PWA.md` - Gu√≠a completa de PWA (instalaci√≥n, offline, etc.)
- `SPRINT1_FEATURES.md` - Calculadora de placas, warmups, calibraci√≥n
- `SPRINT2_FEATURES.md` - Biblioteca extendida, supersets
- `SPRINT3-4_FEATURES.md` - Versionado, resumen anual, accesibilidad

### Enlaces Externos
- [Firebase Docs](https://firebase.google.com/docs)
- [Firestore Security Rules](https://firebase.google.com/docs/firestore/security/get-started)
- [React Query Docs](https://tanstack.com/query/latest)
- [Radix UI](https://www.radix-ui.com/)
- [shadcn/ui](https://ui.shadcn.com/)
- [TailwindCSS](https://tailwindcss.com/)

---

## üë• Roles y Responsabilidades

### Desarrollador Frontend
- Componentes React
- Hooks de estado (React Query)
- Estilos (TailwindCSS)
- Routing (React Router)
- PWA (Service Worker)

### Desarrollador Backend
- Cloud Functions (TypeScript)
- Firestore Rules
- √çndices compuestos
- Auditor√≠a y logs
- Backups

### Algoritmos & Data Science
- Algoritmos de autorregulaci√≥n (`lib/algorithms.ts`)
- C√°lculo de e1RM
- Detecci√≥n de estancamiento
- Ajuste de volumen

### UX/UI Designer
- Sistema de dise√±o (tokens sem√°nticos)
- Componentes shadcn customizados
- Flujos de usuario
- Accesibilidad (WCAG AA)

### Admin/Coach
- Gesti√≥n de usuarios
- Asignaci√≥n de coaches
- Creaci√≥n de programas
- Revisi√≥n de progreso de clientes

---

## üîí Seguridad

### Autenticaci√≥n
- Firebase Auth con email/password y Google Sign-In
- Tokens JWT manejados autom√°ticamente
- Refresh autom√°tico de tokens

### Autorizaci√≥n
- Roles en tabla separada (`user_roles/`)
- Firestore Rules granulares por rol
- Validaci√≥n server-side en Cloud Functions
- No se conf√≠a en datos client-side

### Datos Sensibles
- Passwords nunca almacenadas (hash autom√°tico por Firebase Auth)
- Tokens de invitaci√≥n con expiraci√≥n (7 d√≠as)
- Logs de auditor√≠a inmutables (write: false)

### HTTPS & CORS
- Todas las conexiones a Firebase son HTTPS
- CORS configurado autom√°ticamente por Firebase

---

## üéØ KPIs de Producto

### Adherencia
- **Meta:** ‚â•80% de adherencia promedio
- **C√°lculo:** (workouts completados / workouts planificados) √ó 100

### Tiempo de Logging
- **Meta:** <5 segundos por set
- **Antes:** ~15 segundos (sin calculadora de placas)
- **Despu√©s:** ~5 segundos (con calculadora inline)

### Retenci√≥n
- **Meta:** ‚â•60% retenci√≥n a 30 d√≠as
- **Medici√≥n:** Usuarios activos (‚â•1 workout) en √∫ltimos 30 d√≠as

### Satisfacci√≥n
- **Meta:** NPS ‚â•50
- **Medici√≥n:** Encuesta post-mesociclo

---

## üìà Roadmap Futuro

### Q1 2026
- [ ] Wearables integration (Apple Health, Google Fit, Fitbit)
- [ ] Cloud Function para generar PDF anual
- [ ] FCM Push Notifications
- [ ] 10 plantillas adicionales de programas

### Q2 2026
- [ ] Marketplace de programas (coaches pueden vender)
- [ ] Social features (compartir PRs, seguir amigos)
- [ ] Comparativas con otros usuarios (opcional, an√≥nimo)
- [ ] Integraci√≥n con Strava/MyFitnessPal

### Q3 2026
- [ ] AI Coach (GPT-4 para sugerencias personalizadas)
- [ ] Form check con video an√°lisis (Computer Vision)
- [ ] Predicci√≥n de 1RM con Machine Learning
- [ ] Recomendaciones autom√°ticas de deload

---

## ü§ù Contribuciones

### Convenciones de C√≥digo
- **TypeScript:** Strict mode habilitado
- **Naming:** camelCase para variables, PascalCase para componentes
- **Imports:** Absolute imports con alias `@/`
- **Estilos:** TailwindCSS utility classes, evitar CSS inline

### Git Workflow
- **Branch principal:** `main` (protegida)
- **Feature branches:** `feature/nombre-funcionalidad`
- **Commits:** Conventional Commits (feat, fix, docs, refactor, test)
- **Pull Requests:** Requiere revisi√≥n de 1 persona

### Testing (Pendiente)
- [ ] Unit tests (Vitest)
- [ ] Integration tests (Testing Library)
- [ ] E2E tests (Playwright)
- [ ] Coverage m√≠nimo: 70%

---

## üìû Contacto y Soporte

**Owner:** berluseden  
**Email:** berluseden@gmail.com  
**Repositorio:** github.com/berluseden/dream-android-app

---

**√öltima actualizaci√≥n:** 17 de Octubre, 2025  
**Versi√≥n del documento:** 1.0  
**Estado del proyecto:** MVP en Producci√≥n (85% completado)
